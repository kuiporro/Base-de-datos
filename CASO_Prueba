select * from view_deptCase;

CREATE OR REPLACE VIEW view_deptCase (nombre_dep, ciudad, pais, total_empleados)
AS SELECT d.department_name, l.city, c.country_name, count(e.employee_id) 
        FROM employees e 
        JOIN departments d ON (e.department_id = d.department_id)
        JOIN locations l on (d.location_id = l.location_id)
        JOIN COUNTRIES c on (l.country_id = c.country_id)
        JOIN regions r on (c.region_id = r.region_id)
        where r.region_id = 1
        GROUP BY d.department_name,l.city,c.country_name;
